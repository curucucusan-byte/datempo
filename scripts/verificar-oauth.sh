#!/bin/bash

# Script: Verificar Credenciais OAuth - Agende Mais
# Ajuda a identificar qual Client ID e Secret vocÃª deve usar

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ” VERIFICAÃ‡ÃƒO DE CREDENCIAIS OAUTH - AGENDE MAIS"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

echo "ğŸ“‹ PASSO 1: PEGAR CLIENT ID E SECRET DO GOOGLE CLOUD"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "1. Abra este link (Ctrl+Click):"
echo "   https://console.cloud.google.com/apis/credentials?project=project-966992499199"
echo ""
echo "2. Na seÃ§Ã£o 'OAuth 2.0 Client IDs', procure por:"
echo "   â€¢ 'Web client (auto created by Google Service)' OU"
echo "   â€¢ 'Client for Web application zapagenda-3e479'"
echo ""
echo "3. CLIQUE NO NOME do OAuth Client"
echo ""
echo "4. VocÃª verÃ¡ algo assim:"
echo ""
echo "   Client ID:"
echo "   966992499199-XXXXXXXXXXXXXXXXXXXX.apps.googleusercontent.com"
echo "                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ COPIE ISSO! â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "   Client secret:"
echo "   GOCSPX-XXXXXXXXXXXXXXXXXXXXX"
echo "   â””â”€â”€â”€â”€â”€â”€â”€â”€ COPIE ISSO! â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "5. ANOTE esses valores (vocÃª vai precisar no Passo 2)"
echo ""
read -p "Pressione ENTER quando tiver COPIADO os valores..."
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“‹ PASSO 2: VERIFICAR FIREBASE AUTH"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "1. Abra este link:"
echo "   https://console.firebase.google.com/project/zapagenda-3e479/authentication/providers"
echo ""
echo "2. Clique no provedor 'Google'"
echo ""
echo "3. Na seÃ§Ã£o 'Web SDK configuration', vocÃª verÃ¡:"
echo "   â€¢ Web client ID: (valor atual)"
echo "   â€¢ Web client secret: (valor atual)"
echo ""
echo "4. Compare com os valores que vocÃª copiou no Passo 1"
echo ""
echo "   SÃ£o IGUAIS?"
echo "   â”œâ”€ SIM â†’ O problema estÃ¡ em outro lugar (veja Passo 4)"
echo "   â””â”€ NÃƒO â†’ Continue para o Passo 3"
echo ""
read -p "Pressione ENTER para continuar..."
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“‹ PASSO 3: ATUALIZAR FIREBASE AUTH"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "Se os valores do Passo 1 e Passo 2 sÃ£o DIFERENTES:"
echo ""
echo "1. No Firebase Console (provedor Google), clique em EDITAR"
echo ""
echo "2. Cole os valores que vocÃª copiou do Google Cloud (Passo 1):"
echo "   â€¢ Web client ID: [cole aqui o Client ID do Passo 1]"
echo "   â€¢ Web client secret: [cole aqui o Client Secret do Passo 1]"
echo ""
echo "3. Clique em 'Salvar'"
echo ""
echo "4. Aguarde 2-3 minutos para propagar"
echo ""
read -p "Pressione ENTER quando tiver SALVO..."
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“‹ PASSO 4: VERIFICAR URIs NO GOOGLE CLOUD"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "Volte para o Google Cloud Console (OAuth Client):"
echo "https://console.cloud.google.com/apis/credentials?project=project-966992499199"
echo ""
echo "Verifique se TODOS esses URIs estÃ£o configurados:"
echo ""
echo "ğŸ“ Authorized JavaScript origins:"
echo "   âœ“ https://zapagenda-3e479.firebaseapp.com"
echo "   âœ“ https://zap-agenda.onrender.com"
echo "   âœ“ http://localhost:3000"
echo ""
echo "ğŸ“ Authorized redirect URIs:"
echo "   âœ“ https://zapagenda-3e479.firebaseapp.com/__/auth/handler"
echo "   âœ“ https://zap-agenda.onrender.com/__/auth/handler"
echo "   âœ“ http://localhost:3000/__/auth/handler"
echo ""
echo "Se algum estiver FALTANDO:"
echo "   1. Clique em 'ADD URI'"
echo "   2. Cole o URI faltante"
echo "   3. Clique em 'SAVE'"
echo ""
read -p "Pressione ENTER quando tiver VERIFICADO..."
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“‹ PASSO 5: ATUALIZAR VARIÃVEIS NO RENDER.COM"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "âš ï¸  IMPORTANTE: As variÃ¡veis de ambiente CORRETAS sÃ£o:"
echo ""
echo "GOOGLE_CLIENT_ID (do Google Cloud, Passo 1)"
echo "GOOGLE_CLIENT_SECRET (do Google Cloud, Passo 1)"
echo ""
echo "âŒ NÃƒO confunda com:"
echo "   NEXT_PUBLIC_FIREBASE_* â† Essas sÃ£o DIFERENTES!"
echo ""
echo "1. Abra: https://dashboard.render.com/"
echo "2. Clique no serviÃ§o 'zap-agenda'"
echo "3. VÃ¡ em 'Environment'"
echo "4. Procure por estas variÃ¡veis:"
echo ""
echo "   GOOGLE_CLIENT_ID"
echo "   GOOGLE_CLIENT_SECRET"
echo ""
echo "5. Se existirem, ATUALIZE com os valores do Passo 1"
echo "   Se NÃƒO existirem, ADICIONE:"
echo ""
echo "   Nome: GOOGLE_CLIENT_ID"
echo "   Valor: [Cole o Client ID do Passo 1]"
echo ""
echo "   Nome: GOOGLE_CLIENT_SECRET"
echo "   Valor: [Cole o Client Secret do Passo 1]"
echo ""
echo "6. Clique em 'Save Changes'"
echo "7. Aguarde o deploy automÃ¡tico (2-3 minutos)"
echo ""
read -p "Pressione ENTER quando o deploy terminar..."
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ§ª PASSO 6: TESTAR"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "1. Aguarde 5 minutos apÃ³s o deploy"
echo ""
echo "2. Abra uma JANELA ANÃ”NIMA (Ctrl+Shift+N)"
echo ""
echo "3. VÃ¡ em: https://zap-agenda.onrender.com/login"
echo ""
echo "4. Abra DevTools (F12) â†’ Console"
echo ""
echo "5. Clique em 'Continuar com Google'"
echo ""
echo "6. O que aconteceu?"
echo "   â”œâ”€ âœ… Funcionou! â†’ Problema resolvido!"
echo "   â””â”€ âŒ Mesmo erro â†’ Veja Troubleshooting abaixo"
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ”§ TROUBLESHOOTING"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "Se ainda der erro 'invalid_client':"
echo ""
echo "OpÃ§Ã£o 1: RECRIAR O OAUTH CLIENT"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "1. Google Cloud Console â†’ Credentials"
echo "2. Clique nos 3 pontinhos do OAuth Client â†’ DELETE"
echo "3. Clique em 'CREATE CREDENTIALS' â†’ 'OAuth client ID'"
echo "4. Application type: 'Web application'"
echo "5. Name: 'zapagenda-web-client'"
echo "6. Adicione os URIs (Passo 4)"
echo "7. Clique em 'CREATE'"
echo "8. COPIE o novo Client ID e Secret"
echo "9. ATUALIZE no Firebase (Passo 3)"
echo "10. ATUALIZE no Render (Passo 5)"
echo ""
echo "OpÃ§Ã£o 2: VERIFICAR DOMÃNIO AUTORIZADO"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "1. Google Cloud Console â†’ OAuth consent screen"
echo "2. Clique em 'EDIT APP'"
echo "3. Role atÃ© 'Authorized domains'"
echo "4. Adicione: zapagenda-3e479.firebaseapp.com"
echo "5. Adicione: zap-agenda.onrender.com"
echo "6. Clique em 'SAVE AND CONTINUE'"
echo ""
echo "OpÃ§Ã£o 3: VERIFICAR STATUS DE PUBLICAÃ‡ÃƒO"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "1. Google Cloud Console â†’ OAuth consent screen"
echo "2. Se 'Publishing status' = 'Testing':"
echo "   â†’ Clique em 'PUBLISH APP'"
echo "   â†’ Confirme"
echo "3. Aguarde 5 minutos e teste novamente"
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“ RESUMO DAS VARIÃVEIS"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "No Render.com, vocÃª DEVE ter:"
echo ""
echo "# Credenciais do Google OAuth (Google Cloud Console)"
echo "GOOGLE_CLIENT_ID=966992499199-XXXXXXXXXXXX.apps.googleusercontent.com"
echo "GOOGLE_CLIENT_SECRET=GOCSPX-XXXXXXXXXXXXXXXXXXXXX"
echo ""
echo "# ConfiguraÃ§Ã£o do Firebase (Firebase Console)"
echo "NEXT_PUBLIC_FIREBASE_API_KEY=AIza..."
echo "NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=zapagenda-3e479.firebaseapp.com"
echo "NEXT_PUBLIC_FIREBASE_PROJECT_ID=zapagenda-3e479"
echo "NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=zapagenda-3e479.firebasestorage.app"
echo "NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=966992499199"
echo "NEXT_PUBLIC_FIREBASE_APP_ID=1:966992499199:web:..."
echo ""
echo "# Service Account (para server-side)"
echo "FIREBASE_SERVICE_ACCOUNT_KEY={...json...}"
echo ""
echo "# URL do app"
echo "APP_BASE_URL=https://zap-agenda.onrender.com"
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "âœ… CONCLUÃDO!"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "Se seguiu TODOS os passos e ainda nÃ£o funciona:"
echo ""
echo "1. Tire screenshots de:"
echo "   â€¢ OAuth Client no Google Cloud (URIs configurados)"
echo "   â€¢ Provedor Google no Firebase (Client ID mascarado)"
echo "   â€¢ VariÃ¡veis de ambiente no Render"
echo "   â€¢ Erro completo no console do navegador"
echo ""
echo "2. Mande aqui para anÃ¡lise detalhada"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
